<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<title>هوش مصنوعی</title>
<style>
/* ========================== */
/* Reset و فونت */
* {margin:0; padding:0; box-sizing:border-box;}
body {
  font-family: 'Vazir', sans-serif;
  background: linear-gradient(135deg, #0b0f2a, #1c1f3a);
  color: #fff;
  height: 100vh;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  overflow: hidden;
}
/* بک‌گراند ذرات */
body::before {
  content:"";
  position:absolute;
  top:0; left:0;
  width:100%; height:100%;
  background-image: radial-gradient(#5a6af0 1px, transparent 1px);
  background-size: 20px 20px;
  opacity:0.2;
  z-index:-1;
}

/* هدر */
header {
  text-align:center;
  padding:20px;
  font-size:2em;
  font-weight:bold;
  color:#5a6af0;
  text-shadow: 0 0 10px #5a6af0;
}

/* Chat box */
.chat-container {
  flex:1;
  overflow-y:auto;
  padding:20px;
  margin: 0 10px;
  background: rgba(255,255,255,0.05);
  border-radius: 20px;
  backdrop-filter: blur(10px);
  display:flex;
  flex-direction:column;
  gap:10px;
}

/* پیام‌ها */
.msg {
  padding:12px 18px;
  border-radius: 20px;
  max-width:70%;
  animation: fadeIn 0.3s ease-in-out;
  word-wrap: break-word;
}
.msg.user { 
  background: rgba(90, 106, 240,0.7); 
  align-self:flex-end;
  text-align:right;
}
.msg.ai { 
  background: rgba(255,255,255,0.1); 
  align-self:flex-start;
  text-align:left;
}

/* Input box */
.input-box {
  display:flex;
  padding:10px;
  background: rgba(0,0,0,0.2);
  backdrop-filter: blur(15px);
  border-top:1px solid rgba(255,255,255,0.1);
}
.input-box input {
  flex:1;
  padding:15px;
  border:none;
  border-radius: 10px;
  margin-right:10px;
  outline:none;
  background: rgba(255,255,255,0.05);
  color:#fff;
}
.input-box button {
  padding:15px 25px;
  border:none;
  border-radius:10px;
  background:#5a6af0;
  color:#fff;
  font-weight:bold;
  cursor:pointer;
  transition:0.3s;
}
.input-box button:hover {
  background:#7a89ff;
}

/* Footer */
footer {
  text-align:center;
  padding:15px;
  font-size:0.9em;
  color:#aaa;
}

/* انیمیشن پیام */
@keyframes fadeIn {
  from {opacity:0; transform: translateY(10px);}
  to {opacity:1; transform: translateY(0);}
}
</style>
</head>
<body>
<header>دبیرستان امام خامنه‌ای - هوش مصنوعی</header>

<div class="chat-container" id="chat"></div>

<div class="input-box">
  <input id="inp" placeholder="پیام خود را بنویسید...">
  <button onclick="send()">ارسال</button>
</div>

<footer>طراحی و توسعه داده شده توسط سپهر قاسمی و ماهان جهاندیده</footer>

<script>
const workerURL = "https://khameneischoolai.kameneischool.workers.dev";

async function send() {
  const inpEl = document.getElementById("inp");
  const chatEl = document.getElementById("chat");
  let msg = inpEl.value.trim();
  if(!msg) return;

  // نمایش پیام کاربر
  const userMsg = document.createElement("div");
  userMsg.className = "msg user";
  userMsg.textContent = msg;
  chatEl.appendChild(userMsg);
  inpEl.value = "";
  chatEl.scrollTop = chatEl.scrollHeight;

  // نمایش پیام در حال پردازش
  const aiMsg = document.createElement("div");
  aiMsg.className = "msg ai";
  aiMsg.textContent = "در حال پردازش...";
  chatEl.appendChild(aiMsg);
  chatEl.scrollTop = chatEl.scrollHeight;

  try {
    const res = await fetch(workerURL, {
      method:"POST",
      headers: {"Content-Type":"application/json"},
      body: JSON.stringify({ message: msg })
    });
    const data = await res.json();
    aiMsg.textContent = data.reply || "خطا در دریافت پاسخ";
  } catch(e) {
    aiMsg.textContent = "خطا در اتصال به Worker";
  }
}
</script>
</body>
</html>
